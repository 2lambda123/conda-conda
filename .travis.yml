language: python
python:
  # We don't actually use the system Python but this keeps it organized.
  - "2.7"
  - "3.3"
  - "3.4"
  - "3.5"

install:
  - printenv
  - if [[ "$TRAVIS_PYTHON_VERSION" == "2.7" ]]; then
      wget http://repo.continuum.io/miniconda/Miniconda-3.5.2-Linux-x86_64.sh -O miniconda.sh;
    elif [[ "$TRAVIS_PYTHON_VERSION" == "3.3" ]]; then
      wget http://repo.continuum.io/miniconda/Miniconda3-3.0.0-Linux-x86_64.sh -O miniconda.sh;
    else
      wget http://repo.continuum.io/miniconda/Miniconda3-3.5.2-Linux-x86_64.sh -O miniconda.sh;
    fi
  - bash miniconda.sh -b -p $HOME/miniconda
  - export PATH="$HOME/miniconda/bin:$PATH"
  - hash -r
  - conda config --set always_yes yes
  - bin/conda install --force --no-deps conda
  - conda --version
  - conda info
  - conda install -c conda pytest requests mock conda-env pycrypto pyflakes python=$TRAVIS_PYTHON_VERSION
  - conda install pycosat
  - conda install pip
  - pip install flake8 pytest-cov radon
  - python setup.py install
  - conda info -a
  - printenv

script:
  - shopt -s extglob globstar
  - pyflakes conda/**/!(compat|__init__).py bin setup.py tests
  - py.test --cov conda --cov-report xml tests
  - radon cc --ignore "build,tests,ve,_vendor,progressbar" --no-assert -nb --total-average -s conda
  - radon mi --ignore "build,tests,ve,_vendor,progressbar" -na -m -s conda
  - flake8 --exit-zero --statistics
  - conda --help

addons:
  apt:
    packages:
      - zsh

sudo: false

after_success:
  - pip install codecov
  - codecov --env TRAVIS_PYTHON_VERSION
